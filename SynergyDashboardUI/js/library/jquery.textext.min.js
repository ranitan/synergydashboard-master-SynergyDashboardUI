/**
 * jQuery TextExt Plugin
 * http://textextjs.com
 *
 * @version 1.3.0
 * @copyright Copyright (C) 2011 Alex Gorbatchev. All rights reserved.
 * @license MIT License
 */
!function(t,n){function e(){}function i(){}function r(){}var o,a=(JSON||{}).stringify,s=Array.prototype.slice,u="undefined",p={itemManager:i,plugins:[],ext:{},html:{wrap:'<div class="text-core"><div class="text-wrap"/></div>',hidden:'<input type="hidden" />'},keys:{8:"backspace",9:"tab",13:"enter!",27:"escape!",37:"left",38:"up!",39:"right",40:"down!",46:"delete",108:"numpadEnter"}};if(!a)throw new Error("JSON.stringify() not found");function f(t,n){"string"==typeof n&&(n=n.split("."));var e,i=n.join(".").replace(/\.(\w)/g,function(t,n){return n.toUpperCase()}),r=n.shift();return typeof(e=t[i])!=u?e=e:typeof(e=t[r])!=u&&n.length>0&&(e=f(e,n)),e}function h(){var t,n=s.apply(arguments),e=this,i=1===n.length?e:n.shift();function r(t,n){i.bind(t,function(){return n.apply(e,arguments)})}for(t in n=n[0]||{})r(t,n[t])}function c(t,n){return{input:t,form:n}}(o=i.prototype).init=function(t){},o.filter=function(t,n){var e,i,r=[];for(e=0;e<t.length;e++)i=t[e],this.itemContains(i,n)&&r.push(i);return r},o.itemContains=function(t,n){return 0==this.itemToString(t).toLowerCase().indexOf(n.toLowerCase())},o.stringToItem=function(t){return t},o.itemToString=function(t){return t},o.compareItems=function(t,n){return t==n},(o=e.prototype).init=function(n,e){var i,r,o,a=this;a._defaults=t.extend({},p),a._opts=e||{},a._plugins={},a._itemManager=r=new(a.opts("item.manager")),n=t(n),o=t(a.opts("html.wrap")),i=t(a.opts("html.hidden")),n.wrap(o).keydown(function(t){return a.onKeyDown(t)}).keyup(function(t){return a.onKeyUp(t)}).data("textext",a),t(a).data({hiddenInput:i,wrapElement:n.parents(".text-wrap").first(),input:n}),i.attr("name",n.attr("name")),n.attr("name",null),i.insertAfter(n),t.extend(!0,r,a.opts("ext.item.manager")),t.extend(!0,a,a.opts("ext.*"),a.opts("ext.core")),a.originalWidth=n.outerWidth(),a.invalidateBounds(),r.init(a),a.initPatches(),a.initPlugins(a.opts("plugins"),t.fn.textext.plugins),a.on({setFormData:a.onSetFormData,getFormData:a.onGetFormData,setInputData:a.onSetInputData,anyKeyUp:a.onAnyKeyUp}),a.trigger("postInit"),a.trigger("ready"),a.getFormData(0)},o.initPatches=function(){var n,e=[],i=t.fn.textext.patches;for(n in i)e.push(n);this.initPlugins(e,i)},o.initPlugins=function(n,e){var i,r,o,a=[];for("string"==typeof n&&(n=n.split(/\s*,\s*|\s+/g)),o=0;o<n.length;o++)(r=e[i=n[o]])&&(this._plugins[i]=r=new r,this[i]=function(t){return function(){return t}}(r),a.push(r),t.extend(!0,r,this.opts("ext.*"),this.opts("ext."+i)));for(a.sort(function(t,n){return(t=t.initPriority())===(n=n.initPriority())?0:t<n?1:-1}),o=0;o<a.length;o++)a[o].init(this)},o.hasPlugin=function(t){return!!this._plugins[t]},o.on=h,o.bind=function(t,n){this.input().bind(t,n)},o.trigger=function(){var t=arguments;this.input().trigger(t[0],s.call(t,1))},o.itemManager=function(){return this._itemManager},o.input=function(){return t(this).data("input")},o.opts=function(t){var n=f(this._opts,t);return void 0===n?f(this._defaults,t):n},o.wrapElement=function(){return t(this).data("wrapElement")},o.invalidateBounds=function(){var t,n=this.input(),e=this.wrapElement(),i=e.parent(),r=this.originalWidth+"px";this.trigger("preInvalidate"),t=n.outerHeight()+"px",n.css({width:r}),e.css({width:r,height:t}),i.css({height:t}),this.trigger("postInvalidate")},o.focusInput=function(){this.input()[0].focus()},o.serializeData=a,o.hiddenInput=function(n){return t(this).data("hiddenInput")},o.getWeightedEventResponse=function(t,n){var e={},i=0;for(var r in this.trigger(t,e,n),e)i=Math.max(i,r);return e[i]},o.getFormData=function(t){var n=this.getWeightedEventResponse("getFormData",t||0);this.trigger("setFormData",n.form),this.trigger("setInputData",n.input)},o.onAnyKeyUp=function(t,n){this.getFormData(n)},o.onSetInputData=function(t,n){this.input().val(n)},o.onSetFormData=function(t,n){this.hiddenInput().val(this.serializeData(n))},o.onGetFormData=function(t,n){var e=this.input().val();n[0]=c(e,e)},t(["Down","Up"]).each(function(){var t=this.toString();o["onKey"+t]=function(n){var e=this.opts("keys")[n.keyCode],i=!0;return e&&(i="!"!=e.substr(-1),e=e.replace("!",""),this.trigger(e+"Key"+t),"Up"==t&&this._lastKeyDown==n.keyCode&&(this._lastKeyDown=null,this.trigger(e+"KeyPress")),"Down"==t&&(this._lastKeyDown=n.keyCode)),this.trigger("anyKey"+t,n.keyCode),i}}),(o=r.prototype).on=h,o.formDataObject=c,o.init=function(t){throw new Error("Not implemented")},o.baseInit=function(n,e){n._defaults=t.extend(!0,n._defaults,e),this._core=n,this._timers={}},o.startTimer=function(t,n,e){var i=this;i.stopTimer(t),i._timers[t]=setTimeout(function(){delete i._timers[t],e.apply(i)},1e3*n)},o.stopTimer=function(t){clearTimeout(this._timers[t])},o.core=function(){return this._core},o.opts=function(t){return this.core().opts(t)},o.itemManager=function(){return this.core().itemManager()},o.input=function(){return this.core().input()},o.val=function(t){var n=this.input();if(typeof t===u)return n.val();n.val(t)},o.trigger=function(){var t=this.core();t.trigger.apply(t,arguments)},o.bind=function(t,n){this.core().bind(t,n)},o.initPriority=function(){return 0};var g=!1,l=t.fn.textext=function(n){var i;return g||null==(i=t.fn.textext.css)||(t("head").append("<style>"+i+"</style>"),g=!0),this.map(function(){var i=t(this);if(null==n)return i.data("textext");var r=new e;return r.init(i,n),i.data("textext",r),r.input()[0]})};l.addPlugin=function(t,n){l.plugins[t]=n,n.prototype=new l.TextExtPlugin},l.addPatch=function(t,n){l.patches[t]=n,n.prototype=new l.TextExtPlugin},l.TextExt=e,l.TextExtPlugin=r,l.ItemManager=i,l.plugins={},l.patches={}}(jQuery),function(t){function n(){}t.fn.textext.TextExtIE9Patches=n,t.fn.textext.addPatch("ie9",n);var e=n.prototype;e.init=function(t){if(-1!=navigator.userAgent.indexOf("MSIE 9")){t.on({postInvalidate:this.onPostInvalidate})}},e.onPostInvalidate=function(){var t=this.input(),n=t.val();t.val(Math.random()),t.val(n)}}(jQuery);

!function(t){function e(){}t.fn.textext.TextExtTags=e,t.fn.textext.addPlugin("tags",e);var n=e.prototype,a="text-tag",i="."+a,s=".text-label",o={tags:{enabled:!0,items:null},html:{tags:'<div class="text-tags"/>',tag:'<div class="text-tag"><div class="text-button"><span class="text-label"/><a class="text-remove"/></div></div>'}};n.init=function(e){this.baseInit(e,o);var n,a=this.input();this.opts("tags.enabled")&&(n=t(this.opts("html.tags")),a.after(n),t(this).data("container",n),this.on({enterKeyPress:this.onEnterKeyPress,backspaceKeyDown:this.onBackspaceKeyDown,preInvalidate:this.onPreInvalidate,postInit:this.onPostInit,getFormData:this.onGetFormData}),this.on(n,{click:this.onClick,mousemove:this.onContainerMouseMove}),this.on(a,{mousemove:this.onInputMouseMove})),this._originalPadding={left:parseInt(a.css("paddingLeft")||0),top:parseInt(a.css("paddingTop")||0)},this._paddingBox={left:0,top:0},this.updateFormCache()},n.containerElement=function(){return t(this).data("container")},n.onPostInit=function(t){this.addTags(this.opts("tags.items"))},n.onGetFormData=function(t,e,n){var a=13===n?"":this.val(),i=this._formData;e[200]=this.formDataObject(a,i)},n.initPriority=function(){return 100},n.onInputMouseMove=function(t){this.toggleZIndex(t)},n.onContainerMouseMove=function(t){this.toggleZIndex(t)},n.onBackspaceKeyDown=function(t){var e=this.tagElements().last();0==this.val().length&&this.removeTag(e)},n.onPreInvalidate=function(t){var e=this.tagElements().last(),n=e.position();e.length>0?n.left+=e.innerWidth():n=this._originalPadding,this._paddingBox=n,this.input().css({paddingLeft:n.left,paddingTop:n.top})},n.onClick=function(e){var n,o=this,r=o.core(),l=t(e.target),g=0;l.is(".text-tags")?g=1:l.is(".text-remove")?(o.removeTag(l.parents(i+":first")),g=1):l.is(s)&&(n=l.parents(i+":first"),o.trigger("tagClick",n,n.data(a),function(t,e){n.data(a,t),n.find(s).text(o.itemManager().itemToString(t)),o.updateFormCache(),r.getFormData(),r.invalidateBounds(),e&&r.focusInput()})),g&&r.focusInput()},n.onEnterKeyPress=function(t){var e=this.val(),n=this.itemManager().stringToItem(e);this.isTagAllowed(n)&&(this.addTags([n]),this.core().focusInput())},n.updateFormCache=function(){var e=[];this.tagElements().each(function(){e.push(t(this).data(a))}),this._formData=e},n.toggleZIndex=function(t){var e=this.input().offset(),n=t.clientX-e.left,a=t.clientY-e.top,i=this._paddingBox,s=this.containerElement(),o=s.is(".text-tags-on-top"),r=n>i.left&&a>i.top;(!o&&!r||o&&r)&&s[(o?"remove":"add")+"Class"]("text-tags-on-top")},n.tagElements=function(){return this.containerElement().find(i)},n.isTagAllowed=function(t){var e={tag:t,result:!0};return this.trigger("isTagAllowed",e),!0===e.result},n.addTags=function(t){if(t&&0!=t.length){var e,n,a=this.core(),i=this.containerElement();for(e=0;e<t.length;e++)(n=t[e])&&this.isTagAllowed(n)&&i.append(this.renderTag(n));this.updateFormCache(),a.getFormData(),a.invalidateBounds()}},n.getTagElement=function(e){var n,i,s=this.tagElements();for(n=0;n<s.length;n++)if(i=t(s[n]),this.itemManager().compareItems(i.data(a),e))return i;return null},n.removeTag=function(e){var n,i=this.core();if(e instanceof t)n=e,e=e.data(a);else if(null===(n=this.getTagElement(e)))return;n.remove(),this.updateFormCache(),i.getFormData(),i.invalidateBounds()},n.renderTag=function(e){var n=t(this.opts("html.tag"));return n.find(".text-label").text(this.itemManager().itemToString(e)),n.data(a,e),n}}(jQuery);


!function(t){function i(){}t.fn.textext.TextExtPrompt=i,t.fn.textext.addPlugin("prompt",i);var n=i.prototype,o={prompt:"Awaiting input...",html:{prompt:'<div class="text-prompt"/>'}};n.init=function(i){var n,s;this.baseInit(i,o),n=t(this.opts("html.prompt")),t(this).data("container",n),this.core().wrapElement().append(n),this.setPrompt(this.opts("prompt")),(s=i.input().attr("placeholder"))||(s=this.opts("prompt")),i.input().attr("placeholder",""),s&&this.setPrompt(s),t.trim(this.val()).length>0&&this.hidePrompt(),this.on({blur:this.onBlur,focus:this.onFocus,postInvalidate:this.onPostInvalidate,postInit:this.onPostInit})},n.onPostInit=function(t){this.invalidateBounds()},n.onPostInvalidate=function(t){this.invalidateBounds()},n.invalidateBounds=function(){var t=this.input();this.containerElement().css({paddingLeft:t.css("paddingLeft"),paddingTop:t.css("paddingTop")})},n.onBlur=function(t){var i=this;i.startTimer("prompt",.1,function(){i.showPrompt()})},n.showPrompt=function(){var i=this.input();0!==t.trim(this.val()).length||i.is(":focus")||this.containerElement().removeClass("text-hide-prompt")},n.hidePrompt=function(){this.stopTimer("prompt"),this.containerElement().addClass("text-hide-prompt")},n.onFocus=function(t){this.hidePrompt()},n.setPrompt=function(t){this.containerElement().text(t)},n.containerElement=function(){return t(this).data("container")}}(jQuery);